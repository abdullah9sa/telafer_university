[
 {
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<div id=\"student-link-container\" class=\"d-flex justify-content-center align-items-center flex-column\"></div>\n",
  "modified": "2025-01-16 09:26:28.288941",
  "name": "Student Dashboard",
  "private": 0,
  "roles": [],
  "script": "    async function checkAndRedirect() {\n        try {\n            let response = await frappe.call({\n                method: 'frappe.client.get_list',\n                args: {\n                    doctype: 'Student',\n                    filters: { owner: frappe.session.user },\n                    fields: ['name']\n                }\n            });\n\n            if (response && response.message && response.message.length > 0) {\n                const studentName = response.message[0].name;\n                window.location.href = `/app/student/${studentName}`;\n            } else {\n                const dynamicName = `new-student-${Math.random().toString(36).substr(2, 10)}`;\n                window.location.href = `/app/student/${dynamicName}`;\n            }\n        } catch (error) {\n            console.error(\"Error checking student document:\", error);\n        }\n    }\n\n    function showChangePasswordDialog() {\n        const dialog = new frappe.ui.Dialog({\n            title: 'Change Password',\n            fields: [\n                { fieldname: 'old_password', label: 'Old Password', fieldtype: 'Password', reqd: 1 },\n                { fieldname: 'new_password', label: 'New Password', fieldtype: 'Password', reqd: 1 },\n                { fieldname: 'confirm_password', label: 'Confirm Password', fieldtype: 'Password', reqd: 1 },\n            ],\n            primary_action_label: 'Change Password',\n            primary_action(values) {\n                if (values.new_password !== values.confirm_password) {\n                    frappe.msgprint('New Password and Confirm Password do not match');\n                    return;\n                }\n\n                frappe.call({\n                    method: 'frappe.core.doctype.user.user.update_password',\n                    args: {\n                        old_password: values.old_password,\n                        new_password: values.new_password,\n                    },\n                    callback(response) {\n                                               console.log(\"response\");\n                        console.log(response);\n                        if (response.message === 'Password updated') {\n                            frappe.msgprint('Password changed successfully');\n                            dialog.hide();\n                        } else {\n                            frappe.msgprint('Failed to change password. Please try again.');\n                        }\n                    },\n                });\n            },\n        });\n\n        dialog.show();\n    }\n\n\n    // Manage Student Document Button\n    let manageLink = document.createElement(\"a\");\n    manageLink.href = \"#\";\n    manageLink.textContent = \"تعديل المعلومات\";\n    manageLink.className = \"student-button\";\n    manageLink.onclick = (e) => {\n        e.preventDefault();\n        checkAndRedirect();\n    };\n\n    root_element.appendChild(manageLink);\n\n    // Change Password Button\n    let passwordButton = document.createElement(\"a\");\n    passwordButton.href = \"#\";\n    passwordButton.textContent = \"تغيير كلمة المرور\";\n    passwordButton.className = \"password-button\";\n    passwordButton.onclick = (e) => {\n        e.preventDefault();\n        showChangePasswordDialog();\n    };\n\n    root_element.appendChild(passwordButton);",
  "style": "    .student-button {\n        display: inline-block;\n        padding: 15px 30px;\n        margin: 10px;\n        font-size: 18px;\n        color: #fff;\n        text-decoration: none;\n        background-color: #ffc107;\n        border-radius: 5px;\n        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n        transition: background-color 0.3s, transform 0.2s;\n    }\n\n    .student-button:hover {\n        background-color: #e0a800;\n        transform: scale(1.05);\n    }\n    \n    \n    .password-button {\n        display: inline-block;\n        padding: 15px 30px;\n        margin: 10px;\n        font-size: 18px;\n        color: #fff;\n        text-decoration: none;\n        background-color: #156d80;\n        border-radius: 5px;\n        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n        transition: background-color 0.3s, transform 0.2s;\n    }\n    \n    \n    \n    .password-button:hover {\n        background-color: #00ecff;\n        transform: scale(1.05);\n    }\n    "
 }
]